{% extends "base.html" %}
{% block title %}Learning Modules{% endblock %}

{% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    feather.replace();
  });
</script>
<style>
  .container {
    background: linear-gradient(to right, #f0f4ff, #e0f7fa);
    padding: 2rem;
    border-radius: 20px;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
  }
  .module-card a {
    display: block;
    text-decoration: none;
    color: inherit;
  }
  .module-card {
    background: rgba(255, 255, 255, 0.7);
    border-radius: 1.5rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    padding: 1.5rem;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    border: 2px solid transparent;
    position: relative;
  }
  .module-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    border-color: #b2ebf2;
  }
  .module-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: black;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .module-description {
    font-size: 0.95rem;
    color: #555;
  }
  .badge {
    display: inline-block;
    background-color: rgba(128, 222, 234, 0.6);
    color: #004d40;
    font-size: 0.75rem;
    padding: 0.25rem 0.6rem;
    border-radius: 999px;
    font-weight: 600;
    margin-top: 0.5rem;
  }
  .progress-bar-container {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 10px;
    height: 8px;
    margin-top: 0.8rem;
  }
  .progress-bar-fill {
    height: 100%;
    border-radius: 10px;
    background-color: rgba(0, 150, 136, 0.5);
    width: var(--progress, 0%);
  }
  .icon {
    stroke: #333;
    stroke-width: 2;
    width: 20px;
    height: 20px;
    vertical-align: middle;
    margin-right: 0.4rem;
  }
</style>
{% endblock %}

{% set translations = {
  'en': {
    'title': 'Select Your Learning Module',
    'available': 'Available',
    'coming': 'Coming Soon',
    'locked': 'Locked',
    'desc1': 'Basic structures of the human body relevant to dental care.',
    'desc2': 'Key Dutch terms and phrases used in dental practice.',
    'desc3': 'Learn how to speak to patients with confidence and clarity.'
  },
  'ru': {
    'title': 'Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑƒÑ‡ĞµĞ±Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ',
    'available': 'Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾',
    'coming': 'Ğ¡ĞºĞ¾Ñ€Ğ¾',
    'locked': 'Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾',
    'desc1': 'ĞÑĞ½Ğ¾Ğ²Ñ‹ Ğ°Ğ½Ğ°Ñ‚Ğ¾Ğ¼Ğ¸Ğ¸ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºĞ°, Ğ²Ğ°Ğ¶Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¾Ğ»Ğ¾Ğ³Ğ¾Ğ².',
    'desc2': 'ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ³Ğ¾Ğ»Ğ»Ğ°Ğ½Ğ´ÑĞºĞ¸Ğµ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ñ‹, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ Ğ² ÑÑ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸.',
    'desc3': 'ĞĞ°ÑƒÑ‡Ğ¸Ñ‚ĞµÑÑŒ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ Ğ¸ Ğ¿Ğ¾Ğ½ÑÑ‚Ğ½Ğ¾ Ğ¾Ğ±Ñ‰Ğ°Ñ‚ÑŒÑÑ Ñ Ğ¿Ğ°Ñ†Ğ¸ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸.'
  },
  'nl': {
    'title': 'Selecteer je leermodule',
    'available': 'Beschikbaar',
    'coming': 'Binnenkort',
    'locked': 'Geblokkeerd',
    'desc1': 'Basisstructuren van het menselijk lichaam voor tandheelkundige zorg.',
    'desc2': 'Belangrijke Nederlandse termen en uitdrukkingen in de tandheelkunde.',
    'desc3': 'Leer hoe je zelfverzekerd en duidelijk met patiÃ«nten communiceert.'
  },
  'uk': {
    'title': 'Ğ’Ğ¸Ğ±ĞµÑ€Ñ–Ñ‚ÑŒ Ğ½Ğ°Ğ²Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ',
    'available': 'Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾',
    'coming': 'ĞĞµĞ·Ğ°Ğ±Ğ°Ñ€Ğ¾Ğ¼',
    'locked': 'Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²Ğ°Ğ½Ğ¾',
    'desc1': 'ĞÑĞ½Ğ¾Ğ²Ğ¸ Ğ°Ğ½Ğ°Ñ‚Ğ¾Ğ¼Ñ–Ñ— Ğ»ÑĞ´Ğ¸Ğ½Ğ¸ Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¾Ğ»Ğ¾Ğ³Ñ–Ñ‡Ğ½Ğ¾Ñ— Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸.',
    'desc2': 'ĞšĞ»ÑÑ‡Ğ¾Ğ²Ñ– Ğ½Ñ–Ğ´ĞµÑ€Ğ»Ğ°Ğ½Ğ´ÑÑŒĞºÑ– Ñ‚ĞµÑ€Ğ¼Ñ–Ğ½Ğ¸ Ñƒ ÑÑ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¾Ğ»Ğ¾Ğ³Ñ–Ñ—.',
    'desc3': 'ĞĞ°Ğ²Ñ‡Ñ–Ñ‚ÑŒÑÑ Ğ²Ğ¿ĞµĞ²Ğ½ĞµĞ½Ğ¾ ÑĞ¿Ñ–Ğ»ĞºÑƒĞ²Ğ°Ñ‚Ğ¸ÑÑ Ğ· Ğ¿Ğ°Ñ†Ñ–Ñ”Ğ½Ñ‚Ğ°Ğ¼Ğ¸.'
  },
  'es': {
    'title': 'Selecciona tu mÃ³dulo de aprendizaje',
    'available': 'Disponible',
    'coming': 'PrÃ³ximamente',
    'locked': 'Bloqueado',
    'desc1': 'Estructuras bÃ¡sicas del cuerpo humano relevantes para la atenciÃ³n dental.',
    'desc2': 'TÃ©rminos y frases clave en neerlandÃ©s usados en odontologÃ­a.',
    'desc3': 'Aprende a comunicarte con los pacientes con confianza y claridad.'
  },
  'tr': {
    'title': 'Ã–ÄŸrenme ModÃ¼lÃ¼nÃ¼zÃ¼ SeÃ§in',
    'available': 'Mevcut',
    'coming': 'Ã‡ok YakÄ±nda',
    'locked': 'Kilitli',
    'desc1': 'DiÅŸ bakÄ±mÄ±yla ilgili insan vÃ¼cudunun temel yapÄ±larÄ±.',
    'desc2': 'DiÅŸ hekimliÄŸinde kullanÄ±lan temel Hollandaca terimler.',
    'desc3': 'Hastalarla kendinden emin ve net bir ÅŸekilde iletiÅŸim kurmayÄ± Ã¶ÄŸrenin.'
  },
  'fa': {
    'title': 'Ù…Ø§Ú˜ÙˆÙ„ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯',
    'available': 'Ø¯Ø± Ø¯Ø³ØªØ±Ø³',
    'coming': 'Ø¨Ù‡ Ø²ÙˆØ¯ÛŒ',
    'locked': 'Ù‚ÙÙ„ Ø´Ø¯Ù‡',
    'desc1': 'Ø³Ø§Ø®ØªØ§Ø±Ù‡Ø§ÛŒ Ù¾Ø§ÛŒÙ‡ Ø¨Ø¯Ù† Ø§Ù†Ø³Ø§Ù† Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ù…Ø±Ø§Ù‚Ø¨Øªâ€ŒÙ‡Ø§ÛŒ Ø¯Ù†Ø¯Ø§Ù†Ù¾Ø²Ø´Ú©ÛŒ.',
    'desc2': 'Ø§ØµØ·Ù„Ø§Ø­Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ù‡Ù„Ù†Ø¯ÛŒ Ù…ÙˆØ±Ø¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ø¯Ù†Ø¯Ø§Ù†Ù¾Ø²Ø´Ú©ÛŒ.',
    'desc3': 'ÛŒØ§Ø¯ Ø¨Ú¯ÛŒØ±ÛŒØ¯ Ú©Ù‡ Ø¨Ø§ Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¨Ù‡ Ù†ÙØ³ Ø¨Ø§ Ø¨ÛŒÙ…Ø§Ø±Ø§Ù† ØµØ­Ø¨Øª Ú©Ù†ÛŒØ¯.'
  },
  'pt': {
    'title': 'Selecione seu mÃ³dulo de aprendizado',
    'available': 'DisponÃ­vel',
    'coming': 'Em breve',
    'locked': 'Bloqueado',
    'desc1': 'Estruturas bÃ¡sicas do corpo humano relevantes para a odontologia.',
    'desc2': 'Termos e frases principais em holandÃªs usados na prÃ¡tica odontolÃ³gica.',
    'desc3': 'Aprenda a se comunicar com os pacientes com confianÃ§a e clareza.'
  }
} %}

{% set t = translations.get(lang, translations['en']) %}

{% block content %}
<div class="container">
  <h1>{{ t.title }}</h1>
  <div class="grid">
    <div class="module-card">
      <a href="{{ url_for('learnmod_bp.learning_block', module_id=1, block_index=0) }}" style="text-decoration: none;">
        <div class="module-title">
          <svg class="icon" fill="none" viewBox="0 0 24 24"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
          Anatomy & Physiology
        </div>
        <div class="module-description">{{ t.desc1 }}</div>
        <div class="badge">{{ t.available }}</div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" style="--progress: 40%;"></div>
        </div>
      </a>
    </div>
    <div class="module-card">
      <a href="{{ url_for('tests.full_test') }}">
        <div class="module-title">
          <svg class="icon" fill="none" viewBox="0 0 24 24"><path d="M12 20l9-5-9-5-9 5 9 5z"/></svg>
          Dental Terminology
        </div>
        <div class="module-description">{{ t.desc2 }}</div>
        <div class="badge">{{ t.coming }}</div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" style="--progress: 10%;"></div>
        </div>
      </a>
    </div>
    <div class="module-card">
      <a href="{{ url_for('lesson_bp.lesson_view', module_id=categories.dutch[0].id if categories.dutch else -1, lesson_index=0, lang=lang) }}">
        <div class="module-title">
          <svg class="icon" fill="none" viewBox="0 0 24 24"><path d="M5 12h14"/></svg>
          Patient Communication
        </div>
        <div class="module-description">{{ t.desc3 }}</div>
        <div class="badge">{{ t.locked }}</div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" style="--progress: 0%;"></div>
        </div>
      </a>
    </div>
  </div>

  <h2 style="margin-top: 2rem; font-size: 1.5rem; font-weight: bold;">Other Modules</h2>
  <div class="grid">
    {% for module in categories.education[1:] + categories.bi_toets + categories.dutch[1:] %}
    <div class="module-card">
      <a href="{{ url_for('lesson_bp.lesson_view', module_id=module.id, lesson_index=0, lang=lang) }}">
        <div class="module-title">
          <svg class="icon" fill="none" viewBox="0 0 24 24"><path d="M4 4h16v16H4z"/></svg>
          {{ module.title }}
        </div>
        <div class="module-description">{{ module.description }}</div>
        {% set total = module.lessons|length %}
        {% set done = module.lessons|selectattr('id', 'in', user.progress|map(attribute='lesson_id')|list)|list|length %}
        <div class="badge">
          {% if not user.has_subscription %}ğŸ”’ {{ t.locked }}{% else %}{{ t.available }}{% endif %}
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" style="--progress: {{ (done / total * 100) if total > 0 else 0 }}%;"></div>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
